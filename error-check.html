<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Error Checker</title>
</head>
<body>
    <h1>Checking app.js for errors...</h1>
    <pre id="output" style="background: #f5f5f5; padding: 15px; font-family: monospace; white-space: pre-wrap;"></pre>

    <script>
        // Set auth token BEFORE loading app.js
        if (!localStorage.getItem('authToken')) {
            localStorage.setItem('authToken', 'test-token');
            localStorage.setItem('currentUser', 'Admin User');
            localStorage.setItem('currentUserRole', 'Admin');
            localStorage.setItem('currentUserId', '1');
        }
        
        const output = document.getElementById('output');
        
        // Capture console errors
        window.onerror = function(message, source, lineno, colno, error) {
            output.textContent += `\n❌ ERROR at line ${lineno}:${colno}\n`;
            output.textContent += `Message: ${message}\n`;
            output.textContent += `Source: ${source}\n`;
            if (error && error.stack) {
                output.textContent += `Stack: ${error.stack}\n`;
            }
            return false;
        };
        
        output.textContent = 'Loading app.js...\n';
    </script>
    
    <script src="app.js"></script>
    
    <script>
        setTimeout(() => {
            output.textContent += '\n=== CHECKING WHAT LOADED ===\n';
            output.textContent += 'getQueueConfig defined: ' + (typeof getQueueConfig !== 'undefined') + '\n';
            output.textContent += 'renderQueueButtons defined: ' + (typeof renderQueueButtons !== 'undefined') + '\n';
            output.textContent += 'DEFAULT_QUEUE_CONFIG defined: ' + (typeof DEFAULT_QUEUE_CONFIG !== 'undefined') + '\n';
            
            if (typeof DEFAULT_QUEUE_CONFIG !== 'undefined') {
                output.textContent += 'DEFAULT_QUEUE_CONFIG length: ' + DEFAULT_QUEUE_CONFIG.length + '\n';
            }
            
            // Try to check localStorage
            const stored = localStorage.getItem('queueConfiguration');
            output.textContent += '\nqueueConfiguration in localStorage: ' + (stored ? 'YES (' + JSON.parse(stored).length + ' queues)' : 'NO') + '\n';
            
            // Try manually calling getQueueConfig
            if (typeof getQueueConfig !== 'undefined') {
                try {
                    const config = getQueueConfig();
                    output.textContent += '\nCalled getQueueConfig() successfully: ' + config.length + ' queues\n';
                    output.textContent += 'Queue IDs: ' + config.map(q => q.id).join(', ') + '\n';
                } catch(e) {
                    output.textContent += '\nERROR calling getQueueConfig(): ' + e.message + '\n';
                }
            }
            
            output.textContent += '\n✅ app.js loaded without throwing errors\n';
        }, 100);
    </script>
</body>
</html>
