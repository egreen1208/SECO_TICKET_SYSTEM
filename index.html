<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Portal</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="landing-page customer-login-page">
    <header class="landing-banner">
        <div class="landing-banner__logo">
            <img src="seco-logo.png" alt="SECO Energy Logo" class="logo" />
        </div>
        <div class="landing-banner__content">
            <h1>Service Portal</h1>
            <p class="lede">Welcome! Please sign in to submit a service request.</p>
        </div>
    </header>

    <div class="customer-login-container">
        <div class="customer-login-card">
            <h2>Sign In</h2>
            <p class="login-subtitle">Enter your information to continue</p>
            
            <form id="customer-login-form">
                <label>
                    Email Address <span class="required">*</span>
                    <input type="email" id="customer-login-email" required placeholder="john.doe@example.com" autocomplete="email">
                </label>
                
                <label>
                    Password <span class="required">*</span>
                    <input type="password" id="customer-login-password" required placeholder="Enter your password" autocomplete="current-password">
                </label>
                
                <div id="customer-login-error" class="form-error"></div>
                
                <button type="submit" class="btn-primary login-btn">Sign In</button>
            </form>
            
            <div style="margin-top: 16px; padding: 16px; background: rgba(0, 120, 255, 0.1); border-radius: 8px; border-left: 3px solid #0078ff;">
                <p style="margin: 0 0 8px 0; font-weight: 600; color: #003366; font-size: 14px;">Test Accounts:</p>
                <p style="margin: 4px 0; color: #555; font-size: 13px;"><strong>test1@example.com</strong> / password</p>
                <p style="margin: 4px 0; color: #555; font-size: 13px;"><strong>test2@example.com</strong> / password</p>
                <p style="margin: 4px 0; color: #555; font-size: 13px;"><strong>test3@example.com</strong> / password</p>
            </div>
            
            <div class="login-footer">
                <p>Staff members? <a href="tech-login.html" class="staff-link">Access Staff Portal â†’</a></p>
            </div>
        </div>
    </div>

    <script>
        // Customer login handler
        const loginForm = document.getElementById('customer-login-form');
        const loginError = document.getElementById('customer-login-error');
        const emailInput = document.getElementById('customer-login-email');
        const passwordInput = document.getElementById('customer-login-password');

        // Check if already logged in
        const existingCustomer = localStorage.getItem('customerInfo');
        if (existingCustomer) {
            window.location.href = 'landing.html';
        }

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            loginError.textContent = '';

            const email = emailInput.value.trim().toLowerCase();
            const password = passwordInput.value.trim();

            if (!email || !password) {
                loginError.textContent = 'Please enter your email and password.';
                return;
            }

            // Get users from localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Find matching customer account (filter by role === 'customer')
            const account = users.find(
                acc => acc.role === 'customer' && 
                       acc.email && 
                       acc.email.toLowerCase() === email && 
                       acc.password === password &&
                       acc.active !== false
            );

            if (!account) {
                loginError.textContent = 'Invalid email or password. Please try again.';
                return;
            }

            // Store customer info (without password)
            const customerInfo = {
                name: account.name,
                email: account.email,
                username: account.username,
                loginTime: new Date().toISOString()
            };

            localStorage.setItem('customerInfo', JSON.stringify(customerInfo));
            
            // Redirect to landing page
            window.location.href = 'landing.html';
        });
    </script>
</body>
</html>
